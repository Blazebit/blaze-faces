<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:b="http://blazebit.com/faces"
                template="../templates/ui.xhtml">

    <ui:define name="head">
        <style type="text/css">
            .label {
                width:20%;
                padding:4px;
            }

            .value {
                width:80%;
                padding:4px;
            }

            .grid {
                width:100%;
            }

            .error {
                color: red;
            }

            .outputLabel {
                font-weight: bold;
            }

            .grid {
                width:33%;
                padding:4px;
            }
        </style>
    </ui:define>

    <ui:define name="content">
        <h1 class="title ui-widget-header ui-corner-all">Wizard</h1>
        <div class="entry">
            <p>Wizard creates a workflow by creating multiple steps out of a single page form. Only current step is processed partially and
	                next step is displayed if current step passes validations. Wizard flow is sequential by default and this can be managed using the optional ajax flowListeners, simply outcome of a flowListener defines the next
	               step to display.
            </p>
            
            <h:form>
                
                <b:growl id="growl" sticky="true" showDetail="true"/>

                <b:wizard widgetVar="wiz" flowListener="#{userWizard.onFlowProcess}">

                    <b:tab id="personal" title="Personal">

                        <b:panel header="Personal Details">

                            <b:messages />

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Firstname: *" />
                                <b:inputText value="#{userWizard.user.firstname}" required="true" label="Firstname"/>

                                <h:outputText value="Lastname: *" />
                                <b:inputText value="#{userWizard.user.lastname}" required="true" label="Lastname"/>

                                <h:outputText value="Age: " />
                                <b:inputText value="#{userWizard.user.age}" />

                                <h:outputText value="Skip to last: " />
                                <h:selectBooleanCheckbox value="#{userWizard.skip}" />
                            </h:panelGrid>
                        </b:panel>
                    </b:tab>

                    <b:tab id="address" title="Address">
                        <b:panel header="Address Details">

                            <b:messages />

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Street: " />
                                <b:inputText value="#{userWizard.user.street}" />

                                <h:outputText value="Postal Code: " />
                                <b:inputText value="#{userWizard.user.postalCode}" />

                                <h:outputText value="City: " />
                                <b:inputText value="#{userWizard.user.city}" />

                                <h:outputText value="Skip to last: " />
                                <h:selectBooleanCheckbox value="#{userWizard.skip}" />

                            </h:panelGrid>
                        </b:panel>
                    </b:tab>

                    <b:tab id="contact" title="Contact">
                        <b:panel header="Contact Information">

                            <b:messages />

                            <h:panelGrid columns="2" columnClasses="label, value">
                                <h:outputText value="Email: *" />
                                <b:inputText value="#{userWizard.user.email}" required="true" label="Email"/>

                                <h:outputText value="Phone: " />
                                <b:inputText value="#{userWizard.user.phone}"/>

                                <h:outputText value="Additional Info: " />
                                <b:inputText value="#{userWizard.user.info}"/>

                            </h:panelGrid>

                        </b:panel>
                    </b:tab>

                    <b:tab id="confirm" title="Confirmation">
                        <b:panel header="Confirmation">

                            <h:panelGrid id="confirmation" columns="3" columnClasses="grid,grid,grid">
                                <h:panelGrid columns="2" columnClasses="label, value">
                                    <h:outputText value="Firstname: " />
                                    <h:outputText value="#{userWizard.user.firstname}" styleClass="outputLabel"/>

                                    <h:outputText value="Lastname: " />
                                    <h:outputText value="#{userWizard.user.lastname}" styleClass="outputLabel"/>

                                    <h:outputText value="Age: " />
                                    <h:outputText value="#{userWizard.user.age}" styleClass="outputLabel"/>
                                </h:panelGrid>

                                <h:panelGrid columns="2" columnClasses="label, value">
                                    <h:outputText value="Street: " />
                                    <h:outputText value="#{userWizard.user.street}" styleClass="outputLabel"/>

                                    <h:outputText value="Postal: " />
                                    <h:outputText value="#{userWizard.user.postalCode}" styleClass="outputLabel"/>

                                    <h:outputText value="City: " />
                                    <h:outputText value="#{userWizard.user.city}" styleClass="outputLabel"/>
                                </h:panelGrid>

                                <h:panelGrid columns="2" columnClasses="label, value">
                                    <h:outputText value="Email: " />
                                    <h:outputText value="#{userWizard.user.email}" styleClass="outputLabel"/>

                                    <h:outputText value="Phone " />
                                    <h:outputText value="#{userWizard.user.phone}" styleClass="outputLabel"/>

                                    <h:outputText value="Info: " />
                                    <h:outputText value="#{userWizard.user.info}" styleClass="outputLabel"/>

                                    <h:outputText />
                                    <h:outputText />
                                </h:panelGrid>
                            </h:panelGrid>

                            <b:commandButton value="Submit" actionListener="#{userWizard.save}" update="growl" process="@this"/>

                        </b:panel>
                    </b:tab>

                </b:wizard>

            </h:form>

            <h3>Source</h3>
            <b:tabView>
                <b:tab title="wizard.xhtml">
                    <pre name="code" class="xml">
&lt;h:form&gt;

    &lt;b:growl id="growl" sticky="true" showDetail="true"/&gt;

	&lt;b:wizard widgetVar="wiz"
			flowListener="\#{userWizard.onFlowProcess}"&gt;
	
		&lt;b:tab id="personal" title="Personal"&gt;

			&lt;b:panel header="Personal Details"&gt;
			
				&lt;h:messages errorClass="error"/&gt;
				
				&lt;h:panelGrid columns="2" columnClasses="label, value" styleClass="grid"&gt;
					&lt;h:outputText value="Firstname: *" /&gt;
					&lt;b:inputText required="true" label="Firstname"
							value="\#{userWizard.user.firstname}" /&gt;
					
					&lt;h:outputText value="Lastname: *" /&gt;
					&lt;b:inputText required="true" label="Lastname"
							value="\#{userWizard.user.lastname}" /&gt;
					
					&lt;h:outputText value="Age: " /&gt;
					&lt;b:inputText value="\#{userWizard.user.age}" /&gt;
					
					&lt;h:outputText value="Skip to last: " /&gt;
					&lt;h:selectBooleanCheckbox value="\#{userWizard.skip}" /&gt;
				&lt;/h:panelGrid&gt;
			&lt;/b:panel&gt;
		&lt;/b:tab&gt;
			
		&lt;b:tab id="address" title="Address"&gt;
			&lt;b:panel header="Adress Details"&gt;
			
				&lt;h:messages errorClass="error"/&gt;
				
				&lt;h:panelGrid columns="2" columnClasses="label, value"&gt;
					&lt;h:outputText value="Street: " /&gt;
					&lt;b:inputText value="\#{userWizard.user.street}" /&gt;
					
					&lt;h:outputText value="Postal Code: " /&gt;
					&lt;b:inputText value="\#{userWizard.user.postalCode}" /&gt;
					
					&lt;h:outputText value="City: " /&gt;
					&lt;b:inputText value="\#{userWizard.user.city}" /&gt;
					
					&lt;h:outputText value="Skip to last: " /&gt;
					&lt;h:selectBooleanCheckbox value="\#{userWizard.skip}" /&gt;
				&lt;/h:panelGrid&gt;
			&lt;/b:panel&gt;
		&lt;/b:tab&gt;
			
		&lt;b:tab id="contact" title="Contact"&gt;
			&lt;b:panel header="Contact Information"&gt;
				
				&lt;h:messages errorClass="error"/&gt;
			
				&lt;h:panelGrid columns="2" columnClasses="label, value"&gt;
					&lt;h:outputText value="Email: *" /&gt;
					&lt;b:inputText required="true" label="Email"
							value="\#{userWizard.user.email}" /&gt;
					
					&lt;h:outputText value="Phone: " /&gt;
					&lt;b:inputText value="\#{userWizard.user.phone}"/&gt;
					
					&lt;h:outputText value="Additional Info: " /&gt;
					&lt;b:inputText value="\#{userWizard.user.info}"/&gt;
				&lt;/h:panelGrid&gt;
			&lt;/b:panel&gt;
		&lt;/b:tab&gt;
			
		&lt;b:tab id="confirm" title="Confirmation"&gt;
			&lt;b:panel header="Confirmation"&gt;
			
				&lt;h:panelGrid id="confirmation" columns="6"&gt;
					&lt;h:outputText value="Firstname: " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.firstname}" /&gt;
					
					&lt;h:outputText value="Lastname: " /&gt;
					&lt;h:outputText  styleClass="outputLabel"
								value="\#{userWizard.user.lastname}"/&gt;
					
					&lt;h:outputText value="Age: " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.age}" /&gt;&gt;
					
					&lt;h:outputText value="Street: " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.street}" /&gt;
					
					&lt;h:outputText value="Postal Code: " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.postalCode}" /&gt;
					
					&lt;h:outputText value="City: " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.city}" /&gt;
					
					&lt;h:outputText value="Email: " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.email}" /&gt;
					
					&lt;h:outputText value="Phone " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.phone}"/&gt;
					
					&lt;h:outputText value="Info: " /&gt;
					&lt;h:outputText styleClass="outputLabel"
								value="\#{userWizard.user.info}" /&gt;
					
					&lt;h:outputText /&gt;
					&lt;h:outputText /&gt;
				&lt;/h:panelGrid&gt;
				
				&lt;b:commandButton value="Submit" update="growl" 
							actionListener="\#{userWizard.save}"/&gt;
			
			&lt;/b:panel&gt;
		&lt;/b:tab&gt;
		
	&lt;/b:wizard&gt;
	
&lt;/h:form&gt;
                    </pre>
                </b:tab>

                <b:tab title="UserWizard.java">
                    <pre name="code" class="java">
public class UserWizard {

	private User user = new User();
	
	private boolean skip;
	
	private static Logger logger = Logger.getLogger(UserWizard.class.getName());

	public User getUser() {
		return user;
	}

	public void setUser(User user) {
		this.user = user;
	}
	
	public void save(ActionEvent actionEvent) {
		//Persist user
		
		FacesMessage msg = new FacesMessage("Successful", "Welcome :" + user.getFirstname());
		FacesContext.getCurrentInstance().addMessage(null, msg);
	}
	
	public boolean isSkip() {
		return skip;
	}

	public void setSkip(boolean skip) {
		this.skip = skip;
	}
	
	public String onFlowProcess(FlowEvent event) {
		logger.info("Current wizard step:" + event.getOldStep());
		logger.info("Next step:" + event.getNewStep());
		
		if(skip) {
			skip = false;	//reset in case user goes back
			return "confirm";
		}
		else {
			return event.getNewStep();
		}
	}
}
                    </pre>

                </b:tab>
            </b:tabView>

        </div>

    </ui:define>
</ui:composition>